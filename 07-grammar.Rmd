# The Growth of Grammar {#grammar}

<!-- Descriptive generalizations. We summarize the state of grammatical development across languages, noting the challenges posed by radically different representations of grammar across forms.  -->
<!-- Relationship between grammar and the lexicon. We replicate and generalize the analyses, first reported by Bates and colleagues, that link grammatical generalization to children’s vocabulary size.  <!--

<!-- Developmental effects. We follow up on an effect, first reported in Braginsky et al. (2015a), that age modulates the relationship between grammar and the lexicon, and we link this idea to the “process universals” conception.  -->

```{r 7_complexity_forms}
morphosyntax_fields <- c("combine", "complexity", "word_forms", "word_endings",
                         "word_forms_nouns", "word_forms_verbs", 
                         "word_endings_nouns", "word_endings_verbs", 
                         "small_parts_of_words", "word_complexity")

# complexity_forms <- items %>%
#   filter(form == "WS") %>%
#   group_by(language, type) %>%
#   summarise(n = n()) %>%
#   group_by(language) %>%
#   filter(any(morphosyntax_fields %in% type)) %>%
#   spread(type, n) %>%
#   select_(.dots = c("language", "word", morphosyntax_fields)) #%>%
# 
# num_langs <- n_distinct(complexity_forms$language)

num_langs <- 4   # TODO!
```

<!--## Abstract 

How does abstract structure emerge during language learning? On some accounts, children's early syntax emerges from direct generalizations from particular lexical items, while on others, syntactic structure is acquired independently and follows its own timetable. Progress on differentiating these views requires detailed developmental data. Using parent reports of vocabulary and grammar abilities, previous analyses have shown that early syntactic abstraction strongly depends on the growth of the lexicon, providing support for lexicalist and emergentist theories. Using a large crosslinguistic database in four languages, we replicate and extend these findings, demonstrating similar patterns in each language. At the same time, the power of our dataset reveals measurable effects of age over and above those attributable to vocabulary size, and that these effects are greater for aspects of language ability more closely tied to syntax. These findings suggest non-lexical contributions to the growth of syntactic abstraction that all theories must address.-->


## Introduction

For many children, their first words are spoken in isolation. While these single word utterances sometimes seem to be picking out objects in the world (e.g., *ball!*), others seem to convey more complex ideas or desires (e.g., *up!* for *Mommy, pick me up!*). But by two years of age, many children have acquired a large repertoire of words, and are beginning to use them in two- or three-word combinations (e.g., *Mommy up!* or *kitty sleep here*). These utterances will gradually increase in length and complexity in various ways, forming sentences that increasingly reflect the grammatical structure of their native language (e.g., *Mommy, the kitty is sleeping here*). Children also begin to add more verbs, adjectives and other predicates to their working vocabularies, and substantively increase their use of prepositions, articles and other closed class forms that do grammatical work, including the productive use of inflectional morphemes (e.g., English past tense *ed* or *ing*).

Understanding the origins of grammar is critical because children's ability to use morphosyntactically-rich language is thought to reflect the uniquely-human mental machinary that enables speakers to produce novel utterances that have never been heard in the input (@berko1958, @pinker1991). The questions surrounding the development of grammar are challenging.  How do abstract morphosyntactic structures emerge during language learning? What mechanisms underlie the formation of generalizations that support such inferences and allow children to apply them during language production? Does an understanding of the abstract rule-structure of language emerge from the interactions of individual words, or is that structure independently acquired and represented separately?

Broadly speaking, theoretical views on grammatical development generally take one of two forms. On nativist theories like principles and parameters [@chomsky1981;@baker2005], grammar emerges independently from lexical knowledge following its own, largely maturational, timetable.  Moreover, grammatical regularities are mentally represented in a format that is distinct from that used by the lexical system.  In contrast, according to lexicalist theories, mental representations of morphosyntactic structure generally emerge from graded generalizations on the basis of lexical items, and at least early in development, there may be little or no representation of morphosyntactic rules or regularities *per se* [@tomasello2003, @elman1996]. Even when syntactic structures are eventually represented, these representations are directly related to more concrete lexical structures [@bannard2009].

Historically, the study of individual differences has been critial to this debate.  While variation in word learning is generally uncontroversial, individual differences in grammatical development is less clearly aligned with a universalist, nativist perspective.  In contrast, lexicalist theories predict that variation in grammatical development should be tightly yoked to variation in lexical development [@bates1999]. Research has shown that, as with lexical development, there is sizeable variation in exactly when and how children move into using more grammatically complex utterances in their everyday speech.  While some children use primarily multi-word phrases and many closed class forms by 24 months, other children are still primarily producing nouns in single word utterances at that same age (e.g., @bates1988; @bates1999).  Moreover, there is also variation in the kinds of multi-word utterances that children produce.  For example, some children build up sentences from individual words (e.g., *want dat!*), whereas, other children seem to produce utterances that reflect "unanalyzed" chunks of more complex speech (e.g., *iwantdodat!*).

Critically, associations between individual differences in lexical and grammatical development have been robustly substantiated in the literature. Based on the original norming data from the English CDI: Words & Sentences, children with more sophisticated grammatical productions were also those children with the largest vocabularies (@bates1994). Using that same dataset, Marchman and Bates (1994) found that size of verb vocabulary was concurrently related to children's overregularization of past tense inflections (e.g., *daddy goed*), productions that are viewed as a major milestone in the development of grammatical rule-based knowledge.  MAY WANT TO TRIM DOWN THESE REFERENCES. STILL NEED TO PUT IN BIB. Links between lexical development and grammar have also been reported longitudinally (@bates1988; @bates1997), in late talkers (e.g., Paul, 1996, 1997; Rescorla & Schwartz, 1993; Rescorla, Roberts & Dahlsgaard, 1997, 2000; Thal & Tobias, 1994; Thal & Katich, 1996), early talkers (Thal, Bates, Zappia & Oroz, 1996; Thal, Bates, Goodman, & Jahn-Samilo, 1997), and children with neurodevelopmental disorders, such as Williams syndrome (e.g., Singer-Harris, Bellugi, Bates, Jones, & Rossen, 1997). Critically, similar relationships have also been demonstrated in many other languages, including Slovenian (Marjanovic-Umek, Fekonja-Peklaj, & Podlesek, 2013), Hebrew (Maital, Dromi, Sagi, & Bornstein, 2000), Icelandic (Thordardottir, Ellis Weismer, & Evans, 2002), Italian (@caselli1999; @devescovi2005), Bulgarian (Andonova, 2015), Finnish (e.g., @stolt2009), Turkish (Turkay, 2013), Spanish (e.g., Mariscal & Gallego, 2012; @thal2000), and German (Szagun, Steinbrink, Franik, & Stumper, 2006). Finally, strong heritability of the relation between lexical and grammatical level has been documented in behavioral genetic studies of monozygotic and dizygotic twins (@dale2000). In other words, even though genetic factors contribute relatively weakly to each aspect of language assessed individually, the genetic factors that influence lexical growth are the same as those that influence grammatical growth.  COULD ADD BILINGUALS?

While these studies substantiate that vocabulary and grammar development are strongly associated developmentally, the interpretation of these relations is still under debate. Some researchers have interpreted these links to suggest that domain-general learning mechanisms guide the child’s construction of a working linguistic system at many different levels, in this case, learning words and learning grammatical rules (e.g., Bresnan, Tomasello, Elman et al., 1996).  As Bates and MacWhinney proposed many years ago, “the native speaker learns to map phrasal configurations onto propositions, using the same learning principles and representational mechanisms needed to map single words onto their meanings” (@bates1987, p. 163). Other proposals suggest that the process of learning words involves learning both their lexical-semantic and their morphosyntactic properties (e.g., in what constructions they can legally appear and what inflectional morphemes are required). Other theories propose that grammatical knowledge is built up on a case-by-case basis. Early word combinations are often highly routinized and situation specific, suggesting that learning grammar, like word learning, is guided by learning mechanisms that are item specific and frequency dependent. It is only later that grammatical structures become encoded in terms of their abstract syntactic form (e.g. Akhtar, 1999; Lieven, Pine & Baldwin, 1997; Tomasello, 2001). Finally, yet another accounts views the relation as reflecting mechanisms that operate in the opposite direction. Grammatical analysis is a driving force behind word learning, such that the process of analyzing sentences into their constituent grammatical parts facilitates the further acquisition of lexical-semantic knowledge (Anisfeld, Rosenberg, Hoberman & Gasparini, 1998; Gleitman, 1990; @naigles1990).

## Goals of the current analyses

In this chapter, we explore relations between estimates of children's vocabulary size based on the vocabulary checklist and responses on other sections of the Words and Sentences instruments. Many versions of the instruments provide indices of grammar learning by asking about children's use of inflected forms (e.g., *walked*), children's use of overgeneralizations (e.g., *goed*), and the complexity of their word combinations (e.g., *kitty sleeping* / *kitty is sleeping*).  While many studies have examined associations between lexical and grammatical development crosslinguistically, the scope and power of these early studies were limited, relying on relatively small norming samples (1000--2000 children) with few opportunities for direct comparisons of the nature or extent of these relations across multiple languages at the same time. The data available in Wordbank allows analyses of lexical-grammar relations with enhanced statistical power and broader cross-linguistic representation.  

In addition, we explore a hypothesis that was not explicitly tested in these earlier studies: that there remains age-related variance in grammatical development unexplained by vocabulary development. While the overall relationship between grammar and the lexicon provides support for lexicalist theories, the identification of age-related variance would suggest the presence of developmental processes that regulate grammar learning, above and beyond those captured by measures of vocabulary size. Such age-related processes could be either maturational or experiential, and either domain-general (like working memory) or language-specific (like grammatical competency). Importantly, since both nativist and constructivist theories could in principle predict age-linked variance in grammatical development, our goal is not to differentiate these theories, but instead to test this novel prediction and explore its implications for future work on understanding the processes of grammatical development. 

An additional contribution of work is that, due to the size of our dataset, we are able to make more fine-grained distinctions than the initial cut between grammar and the lexicon. In particular, we distinguish morphology from multi-word syntax, since morphological generalizations might be more specifically dependent on vocabulary size than those requiring more global, sentence-level syntactic regularities. Similarly, we distinguish age-related contributions to different parts of the vocabulary. Lexical items like verbs and even more so function words require some syntactic information to learn [@gleitman1990] and hence might be more linked to age-related factors that extend beyond vocabulary size.


## Methods

<!-- We used Wordbank, a structured database of CDI data, to aggregate and archive CDI data across languages and labs. Wordbank is a repository that stores CDI data in a relational database for easy querying and analysis. By collecting language development data at an unprecedented scale, Wordbank enables the exploration of novel hypotheses about the course of lexical and grammatical development. At the time of writing, Wordbank includes data in four languages: English \cite{fenson2007}, Spanish \cite{jackson1993}, Norwegian \cite{simonsen2014}, and Danish \cite{bleses2008}, with both cross-sectional and longitudinal data. This dataset encompasses norming data from each language as well as a number of smaller-scale studies, some of which did not provide data from the grammar sections. %Table \ref{table:num} presents the total number of administrations and the number of administrations for which grammar (Word Form and Complexity) data were also available. -->

In all `r num_langs` languages, the CDI forms contain both vocabulary checklists and other questions relevant to the child's linguistic development. All of the data reported here come from the Words & Sentences form, administered to children ages 16--32 months. Each of these instruments includes a Vocabulary section, which asks whether the child produces each of around 700 words from a variety of semantic and syntactic categories (e.g., _foot_, _run_, _so_); a Word Form section, which asks whether the child produces each of around 30 morphologically inflected forms of nouns and verbs (e.g., _feet_, _ran_); and a Complexity section, which asks whether the child's speech is most similar to the syntactically simpler or more complex versions of around 40 sentences (e.g., _two foot / two feet_, _there a kitty / there's a kitty_). Each language's instrument is not just a translation of the English form, but rather was constructed and normed to reflect the lexicon and grammar of that language. 


To analyze lexical and grammatical development, we derive several measures. Each child's Vocabulary Size is computed as the proportion of words on the corresponding CDI form that the child is reported to produce. Similarly, each child's Word Form score is the proportion of word forms they are reported to produce, and their Complexity score the proportion of complexity items for which they are reported to use the more complex form. We compute all of these quantities as proportions to make the scales comparable across languages.





<!-- In the current study, we present data from XYZ children XYZ months old, using adaptations of the CDI Words \& Sentences form in four languages: English, Spanish, Norwegian, and Danish. We replicate classic findings of strong lexicon-grammar relations and patterns of vocabulary composition across four languages. We also extend these findings through novel analyses afforded by the Wordbank database.  -->


Show number of items in each relevant section.
```{r 7_n_items, fig.cap="Number of items in the words, word forms, and complexity sections for all those instruments with complexity items."}
# n_admin <- admins %>%
#   filter(language %in% complexity_forms$language) %>%
#   group_by(language) %>%
#   summarise(n = n())

# complexity_forms %>%
#   gather(type, num_items, -language) %>%
#   mutate()
#left_join(complexity_forms, n_admin) %>% datatable(rownames = FALSE)
```


Some utility functions for transforming data values. Note the hack of thinking of everything that's not complexity as being word form. Also - some complexity categories are not coded. 

```{r 7_util_funs}
get_coded_type <- function(type, definition) {
  if (type == "combine") return("combine")
  if (type != "complexity") return("word_form")
  parts <- definition %>% str_split(" / ") %>% unlist()
  if (length(parts) != 2) {
    write_lines(sprintf("definition '%s' doesn't parse", definition),
                "bad_defs.txt", append = TRUE)
    return(NA)
  }
  lengths <- parts %>% str_split("[ ']") %>% map(length) %>% unlist()
  if (lengths[1] == lengths[2]) return("morphology") else return("syntax")
}

get_value <- function(type, value) {
  # type_values <- list(
  #   "complexity" = "complex",
  #   "small_parts_of_words" = c("sometimes", "often"),
  #   "word_complexity" = "complex",
  #   "word_forms" = "produces",
  #   "word_endings" = c("sometimes", "often"),
  #   "word_endings_nouns" = "produces",
  #   "word_endings_verbs" = "produces",
  #   "word_forms_nouns" = "produces",
  #   "word_forms_verbs" = "produces"
  # )
  # value == type_values[[type]]
  value %in% c("produces", "yes", "complex", "sometimes", "often")
}
```

## Grammar and the lexicon


Get kid by item data for wordform and complexity items all languages and aggregate them.
```{r 7_grammar_data_fun}
grammar_items <- items %>%
  filter(form == "WS", type %in% morphosyntax_fields) %>%
  mutate(coded_type = map2_chr(type, definition, get_coded_type) %>%
           factor(levels = c("combine", "word_form", "morphology", "syntax"),
                  labels = c("Combine",
                             "Word Form",
                             "Complexity (Morphological)",
                             "Complexity (Syntactic)")))

num_words <- items %>%
  filter(form == "WS", type == "word") %>%
  group_by(language) %>%
  summarise(n = n())

get_grammar_data <- function(lang) {
  print(lang)
  
  lang_grammar_items <- grammar_items %>% filter(language == lang)
  lang_num_words <- num_words[num_words$language == lang,]$n
  
  lang_admins <- admins %>%
    filter(language == lang) %>%
    select(language, form, age, data_id, production) %>%
    mutate(vocab_mean = production / lang_num_words)

  lang_grammar_data <- get_instrument_data(instrument_language = lang,
                                           instrument_form = "WS", 
                                           items = lang_grammar_items$item_id,
                                           iteminfo = lang_grammar_items,
                                           administrations = lang_admins)
  
  lang_grammar_data %>%
    group_by(data_id, type) %>%
    mutate(no_section = all(is.na(value))) %>%
    filter(!no_section) %>%
    mutate(raw_value = value,
           value = ifelse(is.na(raw_value), "", raw_value),
           value = get_value(unique(type), value)) %>%
    select(language, age, data_id, vocab_mean, item_id, definition, type,
           coded_type, raw_value, value)
  
}
```

```{r 7_get_grammar_data, eval=FALSE}
grammar_data <- grammar_items$language %>%
  unique() %>%
  sort() %>%
  map_df(get_grammar_data)
write_feather(grammar_data, "data/grammar_data.feather")
```

Get by kid summary data for all languages.
```{r 7_grammar_summary}
grammar_data <- read_feather("data/grammar_data.feather")

grammar_summary <- grammar_data %>%
  filter(!is.na(coded_type)) %>%
  group_by(language, coded_type, data_id, age, vocab_mean) %>%
  summarise(sum = sum(value),
            diff = length(value) - sum,
            mean = sum / length(value))
```


```{r 7_items}
grammar_items %>%
  filter(coded_type == "Word Form") %>%
  select(language, type, definition) %>%
  arrange(language, type) %>%
  datatable(rownames = FALSE, filter = "bottom", style = "bootstrap",
            options = list(pageLenth = 20))
  
grammar_items %>%
  filter(coded_type == "Complexity") %>%
  select(language, type, definition) %>%
  arrange(language, type) %>%
  datatable(rownames = FALSE, filter = "bottom", style = "bootstrap",
            options = list(pageLenth = 20))
```

Plot score as a function of vocabulary size for each language and measure with model prediction curves.

Note that cubic clms don't work that well here. 

```{r 7_grammar_data_plot}
ggplot(filter(grammar_summary, coded_type != "Combine"),
       aes(x = vocab_mean, y = mean)) + 
  geom_jitter(alpha = 0.2, size = 0.75) +
  facet_grid(coded_type ~ language) + 
  geom_smooth(span = 1) +
  # geom_smooth(method = "clm", formula = y ~ I(x ^ 3) + I(x ^ 2) + x - 1, 
  #             size = 1, se = FALSE)
  labs(x = "Vocabulary size (proportion of items)",
       y = "Grammar score (proportion of items)")
```

```{r 7_combine_age_plot}
combine_age <- grammar_data %>%
  filter(coded_type == "Combine") %>%
  group_by(language, age) %>%
  summarise(prop = sum(value) / n(),
            n = n())

ggplot(filter(combine_age, n > 21), aes(x = age, y = prop)) +
  facet_wrap(~language) +
  geom_jitter() +
  geom_smooth(method = "glm", method.args = list(family = "binomial"),
              se = FALSE) +
  labs(x = "Age (months)", y = "Proportion of children combining")
```

```{r 7_combine_vocab_plot}
combine_vocab <- grammar_data %>%
  filter(coded_type == "Combine") %>%
  mutate(vocab_bin = cut(vocab_mean, breaks = seq(0, 1, 0.05),
                         include.lowest = TRUE)) %>%
  group_by(language, vocab_bin) %>%
  summarise(prop = sum(value) / n(),
            n = n())

ggplot(filter(combine_vocab, n > 21), aes(x = vocab_bin, y = prop)) +
  facet_wrap(~language) +
  geom_jitter() +
  geom_smooth(method = "glm", method.args = list(family = "binomial"),
              se = FALSE) +
  labs(x = "Vocabulary size (proportion of items)",
       y = "Proportion of children combining")
```





<!-- \begin{figure*}[t!] -->
<!-- \centering -->
<!-- \includegraphics[width=.72\textwidth]{plots/grammar_data_plot-1.png} -->
<!-- \caption{\label{fig:grammar} Each point shows an individual child, indicating their total vocabulary size and Word Form or Complexity score, with color showing their age bin (English $n=4137$; Spanish $n=1094$; Norwegian $n=8505$; Danish $n=2074$). Panels show different languages, and curves are logistic regression models fit separately for each language and measure. The models were specified as {\small{\tt{score $\sim$ vocab + age}}}.}  -->
<!-- \end{figure*} -->

By two years, most children have a sizable working vocabulary, including verbs, prepositions, and closed class forms that perform grammatical work. They are also beginning to use multi-word combinations (e.g., _mommy sock_) and may demonstrate productive use of inflectional morphemes (e.g., past tense _-ed_). Previous studies have found a strong connection between the size of the lexicon and grammatical development as measured by the Complexity section, in many languages including English, Italian, Hebrew, and Spanish [see @bates1999]. However, no studies have had the power and cross-linguistic representation to go beyond this initial finding to explore relations to grammatical items that vary in morphosyntactic features. We extend this work by examining grammatical development using two measures: the Word Form checklist as a window into morphology and the Complexity checklist as a window into syntax. For each measure, we investigate the effects of vocabulary size and age.

This suggests that the mechanisms guiding vocabulary and grammar learning are highly interdependent [@tomasello2003;@bresnan2001], a view at odds with the nativist assumption that grammar emerges independent of the lexicon [@chomsky1981].



<!-- \begin{figure} -->
<!-- \begin{center} -->
<!-- \includegraphics[width=\linewidth]{plots/grammar_coef_plot-1.png} -->
<!-- \end{center} -->
<!-- \caption{\label{fig:coefs_grammar} For each language and measure, the model's age effect coefficient. Ranges show the 95\% confidence interval of the coefficient estimate. Across languages, Complexity has a substantially larger age effect than Word Form.} -->
<!-- \end{figure} -->


We wanted to estimate how much variance in children's syntactic and morphological development remains after accounting for that child's vocabulary size. Specifically, we asked whether age provides additional predictive power beyond vocabulary size. To estimate this effect, we fit logistic regression models to each child's Word Form and Complexity scores, predicting score as a function of vocabulary size and age in months. For all languages and measures, the evidence is overwhelmingly in favor of the model using both vocabulary and age as predictors, as compared to the model using only vocabulary (the smallest difference in AIC is 76).

```{r}
#Main effects were always exceedingly reliable, but the interaction term had negligible magnitude and so we omit it here.
```

Figure~\ref{fig:grammar} shows data and models: each dot represents a child's score on a measure, while curves show the relationship between score and vocabulary size.
%As seen most clearly for English and Norwegian---the languages for which we have most data---
For all languages, the curves for Word Form are near-overlapping, showing little differentiation across age groups. This indicates only small contributions of age above and beyond vocabulary. In contrast, the curves for Complexity show a characteristic fan across age groups, indicating that the relationship between vocabulary size and complexity score is modulated by age. %The Spanish and Danish data show less of a clear complexity curve fan, possibly because of the relatively small number of data points in the youngest age group.

<!-- \begin{figure*} -->
<!-- \centering -->
<!-- \includegraphics[width=.45\textwidth]{plots/item_coef_plot_norwegian-1.png} -->
<!-- \includegraphics[width=.45\textwidth]{plots/item_coef_plot_english-1.png}\\ -->
<!-- \includegraphics[width=.45\textwidth]{plots/item_coef_plot_danish-1.png} -->
<!-- \includegraphics[width=.45\textwidth]{plots/item_coef_plot_spanish-1.png} -->
<!-- \caption{\label{fig:interactions} For each language and item, the model's age effect coefficient. Ranges show the 95\% confidence interval of the coefficient estimate. Across languages, Word Form items tend to have smaller age effects, Morphological Complexity items tend to have middling age effects, and Syntactic Complexity items tend to have larger age effects. (Note: No Spanish complexity items had exclusively morphological content.)} -->
<!-- \end{figure*} -->

```{r 7_age_hist}
# ggplot(grammar_data, aes(x=age)) + 
#   geom_histogram() + 
#   facet_wrap(~language)
```

Choosing cut points here is hard, since the age distribution/density is different from language to language. 

```{r 7_age_plot, fig.width=8}
# grammar_summary_age <- grammar_data %>%
#   filter(!is.na(age)) %>%
#   mutate(age_group = cut(age, c(12, 20, 28, 36))) %>%
#   group_by(language, coded_type, data_id, age_group, vocab_mean) %>%
#   summarise(sum = sum(value),
#             diff = length(value) - sum,
#             mean = sum / length(value))
# 
# ggplot(grammar_summary_age %>% filter(!(language %in% c("Slovak","Mandarin"))),
#        aes(x = vocab_mean, y = mean, fill = age_group, col = age_group)) + 
#   geom_jitter(alpha = 0.2, size = 0.75) +
#   facet_grid(coded_type ~ language) + 
#   # geom_smooth(method = "clm", formula = y ~ I(x ^ 3) + I(x ^ 2) + x - 1, 
#   #             size = 1, se = FALSE) + 
#   geom_smooth(method = "loess", se = FALSE, span = 1) + 
#   scale_colour_solarized() + 
#   scale_fill_solarized()
```


<!--
UNUSED MODEL BASED ANALYSES BELOW

Plot age effect coefficients for each language and measure.
```{r grammar_coef_plot, fig.width=6, fig.height=4, eval=FALSE}
ggplot(grammar.model.metrics, 
       aes(x=language, y=age.coef, fill=measure)) + 
  geom_bar(position="dodge", stat="identity") + 
  geom_linerange(aes(ymin=age.coef-1.96*age.se, ymax=age.coef+1.96*age.se), 
                 position = position_dodge(width=.9)) +
  ylab("Age effect coefficient") + 
  xlab("") +
  theme_bw(base_size = 14) +
  scale_fill_brewer(palette="Set2",
                    name="Measure") +
  theme(legend.position = c(0.15,0.86),
        legend.text = element_text(size=14),
        legend.title = element_text(size=15),
        legend.key.height = unit(1.5, "char"),
        legend.key = element_blank(),
        legend.background = element_rect(fill="transparent"),
        text=element_text(family=font))
```

Fit models for each wordform and complexity item and get their age coefficients.
```{r item_models, eval=FALSE}
item.models <- grammar.data %>%
  group_by(language, item, coded.type) %>%
  do(model = glm(value ~ vocab.mean + age, data = ., family = "binomial")) %>%
  mutate(coef = coef(model)["age"],
         se = se.coef(model)["age"])
```

Function for plotting age effect coefficients by item for a language.
```{r item_coef_plot_fun, eval=FALSE}
plot.item.coefs <- function(item.models, lang) {
  
  lang.item.models <- filter(item.models, language == lang) %>%
    arrange(coef) %>%
    mutate(item = factor(item, levels=item))
  
  item.plot <- ggplot(lang.item.models,
                      aes(x=item, y=coef, fill=coded.type, label=item)) +
    geom_bar(stat="identity", position="identity", alpha=.5, width=0.9) +
    geom_linerange(aes(ymin=coef-1.96*se, ymax=coef+1.96*se),
                   position = position_dodge(width=.9)) +
    theme_bw(base_size = 12) +
    scale_y_continuous(name="Age Effect Coefficient") +
    scale_x_discrete(name="",breaks=NULL) +
    annotate("text", x = length(lang.item.models$item)/2,
             y = min(lang.item.models$coef-1.96*lang.item.models$se), vjust=0,
             label = lang, size = 9, family=font) +
    scale_fill_brewer(palette="Set2", name="Item Type", drop=FALSE) +
    theme(legend.position = c(0.22,0.82),
          legend.text = element_text(size=14),
          legend.title = element_text(size=13),
          legend.key = element_blank(),
          legend.key.height = unit(1.5, "char"),
          text = element_text(family=font),
          axis.title.y = element_text(size=16),
          axis.text.y = element_text(size=13))
  
  return(item.plot)
  
  }
```

Plot item interactions for Norwegian.
```{r item_coef_plot_norwegian, fig.width=8, fig.height=4, eval=FALSE}
plot.item.coefs(item.models, "Norwegian")
```

Plot item interactions for English.
```{r item_coef_plot_english, fig.width=8, fig.height=4, eval=FALSE}
plot.item.coefs(item.models, "English")
```

Plot item interactions for Danish.
```{r item_coef_plot_danish, fig.width=8, fig.height=4, eval=FALSE}
plot.item.coefs(item.models, "Danish")
```

Plot item interactions for Spanish.
```{r item_coef_plot_spanish, fig.width=8, fig.height=4, eval=FALSE}
plot.item.coefs(item.models, "Spanish")
```

-->

Because of the size of our samples, all main effects and interactions are highly significant. To assess the extent of the age contribution to children's morphological and syntactic development, we compared the coefficients of Word Form and Complexity models. Figure~\ref{fig:coefs_grammar} shows the coefficient of the age effect for each measure across languages. In each language, the age effect coefficient is substantially larger for Complexity than Word Form, indicating a greater age effect on those items that generally align with syntax than morphology.

Given the heterogeneous nature of the CDI instruments, particularly in the Complexity sections, we further broke down these items by classifying them as capturing more morphological or more syntactic phenomena. Items for which the difference between the simple and complex sentences is in the inflection of a noun or verb (such as \emph{doggie kiss me / doggie kissed me}) were coded as Morphological. The remainder of the items were coded as Syntactic, since they involve the use of some sentence-level syntactic construction (such as \emph{doggie table / doggie on table}).

We then fit predictive models as above separately for every item. Figure \ref{fig:interactions} shows the age effect coefficient of each item. In general, there is a three-way split: age effects are smallest for Word Form items, then Morphological Complexity items, and largest for Syntactic Complexity items, suggesting more syntactic phenomena have greater age contributions. 

Building on previous analyses that showed a strong relationship between lexical and grammatical development, we added age into this relationship. Across languages, our measures of syntactic development consistently showed greater age modulation than measures of morphological development. Further distinguishing between items that were more reflective of morphology than syntax, we again found greater age effects for more syntactic items. Thus, this analysis provides evidence for a relationship between syntactic development and age \emph{not} captured by lexical development.



## Discussion

The current study revisits classic findings but also explores novel questions regarding lexicon-grammar relations and vocabulary composition through Wordbank, a newly-developed web-based tool for cross-linguistic analyses of large CDI datasets. Our results provided general support for a lexicalist view, in that, in `r num_langs` languages, variance in vocabulary production strongly aligned with variance in grammar. However, we also estimated additional age-related contributions, specifically contrasting the links to morphological forms vs. syntactic constructions, and for different lexical categories. In general, we find that measures of grammar that are more closely aligned with syntax are modulated by age to a greater extent than those reflecting inflectional morphology. Also, we find that the trajectories of predicate and function word representation in the vocabulary are modulated by age to a greater extent than noun representation (albeit with some variability across languages). Both findings suggest a place for developmental processes that facilitate grammatical acquisition beyond pure lexical growth.

Our analyses suggest interesting new areas of research regarding possible mechanisms driving children's early lexical development and how those mechanisms might support children's transition from single words to more morphosyntactically complex utterances. One possibility is that these developments are dependent on maturational factors that operate on grammatical development in a domain-specific way, independent of lexical-semantic processes. Another possibility is that age-related effects represent more domain-general learning mechanisms, such as attention or working memory, that provide differential support for sentence-level processes than word-internal ones \cite{gathercole2014}. Future studies should also explore the extent to which lexical and age-related processes are shaped, either independently or in tandem, by features of the learning environments that children experience \cite<e.g.,>{weisleder2013}.

Questions about the nature of morphosyntactic representations in early language have often seemed deadlocked. But by mapping out developmental change across large samples and multiple languages, our findings here challenge theories across the full range of perspectives to more fully describe the mechanistic factors underlying the interaction of vocabulary, grammar, and development. 

<!--

```{r}
# + 
#   scale_x_continuous(limits = c(0,1), breaks = seq(0,1,.2),
#                      name = "\nVocabulary Size") + 
#   scale_y_continuous(limits = c(0,1), breaks = seq(0,1,.25),
#                      "Score (Mean Items)\n") + 
#   theme_bw(base_size = 11) +
#   theme(legend.position = c(0.055,0.925),
#         legend.text = element_text(size=9),
#         legend.title = element_text(size=9),
#         legend.key.height = unit(1, "char"),
#         legend.key.width = unit(0.4, "cm"),
#         legend.key = element_blank(),
#         legend.background = element_rect(fill="transparent"),
#         text=element_text(family=font)) +
#   scale_color_brewer(type="div", palette=9,
#                      name="Age Group\n (months)") +
#   scale_fill_brewer(palette = "Spectral",
#                     guide=FALSE)
```

Show these same models broken down by age. 

Fit grammar score models and use them to predict data.
```{r 7_grammar_predict, eval=FALSE}
grammar_models <- grammar_summary %>%
  group_by(language, measure) %>%
  do(model = glm(cbind(sum, diff) ~ vocab_mean,
                 data = ., family="binomial"))

get.grammar.model <- function(lang, meas) {
  return(filter(grammar.models, language == lang, measure == meas)$model[[1]])
  }

grammar.predicted.data <- grammar.summary %>%
  group_by(language, measure) %>%
  mutate(predicted = invlogit(predict.lm(get.grammar.model(unique(language),
                                                           unique(measure)),
                                         data = ., family="binomial")))
```

P

Model comparison: fit grammar models and get their AICs and age coefficients.
```{r grammar_models, eval=FALSE}
grammar.model.metrics <- grammar.summary %>%
  group_by(language, measure) %>%
  do(model.vocab = glm(cbind(sum,diff) ~ vocab.mean, data = .,
                       family="binomial"),
     model.vocab.age = glm(cbind(sum,diff) ~ vocab.mean + age, data = .,
                           family="binomial"),
     model.vocab.age = glm(cbind(sum,diff) ~ vocab.mean * age, data = .,
                           family="binomial")) %>%
  mutate(AIC.vocab = AIC(model.vocab),
         AIC.vocab.age = AIC(model.vocab.age),
         deltaAIC = AIC.vocab - AIC.vocab.age,
         age.coef = coef(model.vocab.age)["age"],
         age.se = se.coef(model.vocab.age)["age"])
```

Show AICs of grammar models.
```{r grammar_aic, eval=FALSE}
kable(select(grammar.model.metrics,
             language, measure, AIC.vocab, AIC.vocab.age, deltaAIC))
```

-->
