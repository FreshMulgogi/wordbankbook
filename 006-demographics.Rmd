# Demographic Effects on Vocabulary Size {#demographics}

Chapter \@ref(vocabulary) examined cross-linguistic consistency and variability in children's reported vocabulary.  In this chapter, we follow up these analyses by beginning the process -- which will span throughout the book -- of attempting to understand the nature and sources of these differences. In particular, we take advantage of the sample diversity described in Chapter \@ref(methods) to explore differences in the median trajectory of vocabulary growth within demographic groups, focusing on three variables that are relatively available in our data: sex, maternal education, and birth order. Our goal is to develop a framework for comparing the magnitude of these effects.

One important tension in this chapter reflects many earlier discussions of variability in CDI scores [from @fenson1994, @feldman2000, and @eriksson2012, among others]. While some demographic differences in vocabulary are quite consistent -- substantially so, as it turns out -- the overall proportion of variance in vocabulary that they capture is still relatively limited. We will examine a number of different perspectives on how to quantify this relationship, moving back and forth between emphasizing consistency in differences in the central tendency and emphasizing the limited size of these effects relative to the variability documented in Chapter \@ref(vocabulary).

Our analyses in this chapter are unfortunately limited to a subset of languages, as demographic data for many contributed datasets were not available. We begin with sex, the variable for which the most analysis has already been done and for which we have the most data, then move on to birth order and finally maternal education. 

```{r demo-vocab_admins}
num_words <- items %>%
  filter(type == "word") %>%
  group_by(language, form) %>%
  summarise(n = n())

vocab_data <- admins %>%
  select(data_id, language, form, age, sex, 
                mom_ed, birth_order, production, comprehension) %>% 
  left_join(num_words) %>%
  mutate(birth_order = fct_collapse(birth_order,
                                    "Third+" = c("Third","Fourth",
                                                 "Fifth","Sixth",
                                                 "Seventh","Eighth")),
         mom_ed = fct_collapse(mom_ed,
                               `Below Secondary` = c("None","Primary",
                                                     "Some Secondary"),
                               `Secondary` = c("Secondary", "Some College"),
                               `College and Above` = c("College",
                                                       "Some Graduate",
                                                       "Graduate")))


```

```{r demo-funs}
N_MAIN_GROUPS <- 5
N_AGE_POINTS <- 4

# get means split by demographic features
get_demo_means <- function (data, demo = ~sex, measure = ~production) {
  data %>%
    group_by(language, form, !!demo, age) %>%
    mutate(measure = !!measure) %>%
    summarise(median = median(.data$measure / n), 
              n = n())
}

# get glmrob models on demographic feature
get_demo_models <- function (data, demo = ~sex, measure = ~production) {
  data %>%
    mutate(measure = !!measure, 
           no_measure = n - .data$measure, 
           demo = !!demo) %>%
    unite(langform, language, form, sep = .inst_sep) %>%
    split(.$langform) %>%
    map(possibly(function(x) {
      # print(x$langform[1])
      robustbase::glmrob(cbind(measure, no_measure) ~ age * demo - demo,
                         family = "binomial",
                         data = x)
    }, otherwise = NULL))
}

# predict from models in the given age range so that you can plot
get_demo_preds <- function (models, data, demo = ~sex) {
  
  demo_name <- rlang::quo_text(demo) # fixme - how do I coerce this more nicely?
  
  data %>%
    unite(langform, language, form, sep = .inst_sep) %>%
    split(.$langform) %>%
    map_df(possibly(function(x) {
      print(x$langform[1])
      
      new_data <- list(age = min(x$age):max(x$age),
                       demo = unique(pull(x, !!demo)), 
                       langform = x$langform[1]) %>%  
        cross_df()    
      
      new_data$pred <- predict(models[[x$langform[1]]],
                               newdata = new_data, type = "response")
      return(new_data)
    }, otherwise = tibble())) %>%
    rename(!!demo_name := demo) %>%
    separate(langform, into = c("language","form"), sep = .inst_sep) 
}

# get the appropriate coefficient from the model and corresponding p value
get_demo_model_summary <- function (models, level = "Male") {
  coef_name <- quo(paste0("age:demo", level))
  
  models %>%
    map_df(possibly(function(x) {
      # print(x$language[1])
      p <- summary(x)$coefficients[eval_tidy(coef_name), 'Pr(>|z|)']
      beta <- summary(x)$coefficients[eval_tidy(coef_name), 'Estimate']
      return(data_frame(beta = round(beta, 4), 
                        p = round(p, 4)))
    }, otherwise = tibble(p = NA, beta = NA))) %>%
    mutate(langforms = names(models)) %>% # ugly 
    separate(langforms, into = c("language","form"), sep = .inst_sep) %>%
    select(language, form, beta, p) %>%
    arrange(beta)
}

# compute MMAD effect size measure by the demographic and particular levels
# tricky to filter outliers but important, the current policy is to filter cases 
# where there are fewer than N_MAIN_GROUPS in each of the two main groups that are being used for MMAD comparison. 

get_mmad_ratio <- function(data, measure = quo(production), demo = quo(sex), 
                           high_level = "Female", low_level = "Male") {
  
  data %>%
    group_by(language, form, age, !!demo) %>%
    filter(n() > N_MAIN_GROUPS | !(!!demo %in% c(high_level,low_level))) %>%
    mutate(measure = !!measure) %>%
    summarise(median = median(measure),
              mad = mad(measure),
              n = n()) %>%
    group_by(language, form, age) %>%
    filter(any(!! rlang::get_expr(demo) == high_level), 
           any(!! rlang::get_expr(demo) == low_level)) %>% # one of each necessary level
    summarise(mmad = (median[!!(demo) == high_level] - median[!!(demo) == low_level]) / 
                mean(mad[!!(demo) %in% c(high_level, low_level)]),
              n = sum(n)) %>%
    filter(is.finite(mmad))
}                           

# summarise MMAD across development, again for given demoraphic
get_mmad_summary <- function(data) {
  data %>%
    group_by(language, form) %>%
    summarise(mmad_mean = weighted.mean(mmad, w = n),
              n = n()) %>%
    filter(n > N_AGE_POINTS) %>% # more than four age points - FIXME, arbitrary
    ungroup %>%
    mutate(language = fct_reorder(language, mmad_mean)) 
}
```


```{r demo-analyses, eval=FALSE}
# this code block does all the analyses above to all the combos of measures, forms, and demographics

# build all the combos to analyze
analysis_combos <- left_join(tibble(form = c("WG","WG","WS"), 
                                    measure = c(quo(comprehension),
                                                quo(production),quo(production)), 
                                    measure_name = c("comprehension","production","production"),
                                    index = 1:3), 
                             expand.grid(index = 1:3, 
                                         demo = c(quo(sex), quo(birth_order), quo(mom_ed)))) %>%
  mutate(reference_level = case_when(demo == quo(sex) ~ "Male", 
                                     demo == quo(birth_order) ~ "Second",
                                     demo == quo(mom_ed) ~ "Secondary"), 
         high_level =  case_when(demo == quo(sex) ~ "Female", 
                                 demo == quo(birth_order) ~ "First",
                                 demo == quo(mom_ed) ~ "College and Above"), 
         demo_name = map_chr(demo, rlang::quo_text))

# run all the analyses above on all those combos
analyses <- analysis_combos %>%
  split(list(.$form, .$measure_name)) %>%
  map(function (form_measure_data) {
    form_measure_data %>%
      split(.$demo_name) %>%
      map(possibly(function(demo_data) {
        
        demo <- demo_data$demo[1][[1]]
        measure <- demo_data$measure[1][[1]]
        
        form_class <- demo_data$form[1]
        
        # deal with form classes to include TC/IC etc.
        if (form_class == "WS") { 
          forms <- WSs 
        } else if (form_class == "WG") { 
          forms <- WGs 
        }
        
        data <- vocab_data %>%
          filter(!is.na(!!demo), form %in% forms) 
        
        results <- list()
        results$means <- get_demo_means(data, demo = demo, measure = measure)
        results$models <- get_demo_models(data, demo = demo, measure = measure)
        results$preds <- get_demo_preds(results$models, data, demo = demo)
        results$model_summary <- get_demo_model_summary(results$models, 
                                                        level = demo_data$high_level[1])
        results$mmad_ratio <- get_mmad_ratio(data, measure = measure, demo = demo, 
                                             high_level = demo_data$high_level[1], 
                                             low_level = demo_data$reference_level[1])
        results$mmad_summary <- get_mmad_summary(results$mmad_ratio)
        
        return(results)
      }, 
      otherwise = tibble())) # otherwise for possibly call
  })

save(file = "data/demographics/demo-analyses.Rds", analyses)
```

```{r demo-load}
load(file = "data/demographics/demo-analyses.Rds")
```

## Sex

Our first analysis examines how vocabulary development differs by children's sex.^[Throughout, we will assume that parents report on children's biological sex, rather than their gender identity.] The literature on cognitive differences due to sex is vast, controversial in many places, and difficult to summarize [see @miller2014 for a useful recent review]. Focusing on development, @maccoby1974 began the enterprise of systematizing and summarizing gender differences. Their conclusions were largely deflationary but did suggest some differences in aggression and verbal ability (which were suggested to emerge in the period of early adolescence). This latter claim is most relevant for our analysis, but has been subject to controversy as well. Using meta-analytic tools, @hyde1988 found that differences in verbal ability were minimal, but more recent studies have suggested consistent verbal ability differences. For example, @stoet2013 found differences in reading ability across nations in a massive elementary education dataset (the PISA assessment), with variance in the magnitude of difference, but with girls very consistently showing an advantage. Similarly, @robinson2011 reported consistent differences in reading ability (favoring girls) at the onset of kindergarten in a nationally-representative US sample. 

It almost goes without saying that these findings are subject to the full range of possible explanations articulated in the literature. These range from caregiver and academic socialization (e.g., self-fulfilling expectations that girls are more verbal) to "self socialization" in which affiliative differences produce differences in behavior, all the way to biological explanations.^[As an illustrative example, some literature has implicated fetal testosterone, though by a  @lutchmaya2001 used CDI meausures and recovered an effect somewhat similar to ours with a small sample ($d = .64$ at 18 months with $N=87$), and $d = .60$ at 24 months for a subsample). They found some relationship with fetal testosterone across sexes, but it did not hold up within sex (perhaps due to small samples). The mechanism by which testosterone translates into vocabulary growth is unclear however.] While descriptive data of the type cited above (and reported in our analyses below) can be more or less consistent with some of these theories, conclusive evidence will not be forthcoming.

Our analyses below replicate and extend the results of @eriksson2012, who used an overlapping sample of CDI data from 12 languages to explore sex effects on vocabulary size.^[An earlier version of this analysis was reported in @frank2016.] 

### Comprehension

We begin by examining Words and Gestures data on comprehension. 

```{r demo-gender_plot_wg_comp}
ggplot(analyses$WG.comprehension$sex$means,
       aes(x = age, y = median, colour = sex)) +
  facet_wrap(~interaction(language, form, sep = .inst_sep)) +
  geom_point(aes(size = n),  alpha = .2) +
  geom_line(data = analyses$WG.comprehension$sex$preds, aes(y = pred)) +
  .scale_colour_discrete(name="Sex") +
  scale_x_continuous(breaks = seq(8,
                                  20, 4),
                     limits = c(8, 20),
                     name = "Age (months)") +
  scale_y_continuous(breaks = c(0,.5,1), limits = c(0,1), 
                     name = "Median Comprehension") +
  theme(legend.position = "bottom",
        strip.text.x = element_text(size = 7)) + 
  scale_size(guide = FALSE)
```

Our first plot shows comprehension on Words and Gestures. Visual inspection of the data suggest limited differences, but a female advantage in some languages (most pronounced in Korean, Latvian, and Hebrew). Note that many authors do not find gender differences in early comprehension [e.g., @eriksson2012]. @feldman2000 also did not using a large, relatively representative American dataset, though they had data only from younger children (10-13 months). 

```{r demo-sex_wg_comp}
analyses$WG.comprehension$sex$model_summary %>%
  DT::datatable()
```
We can examine the statistical models to get a clearer picture. For each language, we fit a robust generalized linear model predicting vocabulary size (number of words understood out of the total) predicted by age, and the interaction of age and gender. We specified this simple model so that the coefficient estimate on the age by gender interaction provides a convenient summary of the difference in vocabulary growth across groups. Despite the small magnitudes of the coefficients, `r nrow(filter(analyses$WG.comprehension$sex$model_summary, p < .05, beta < 0))` of `r nrow(analyses$WG.comprehension$sex$model_summary)` languages had a female advantage. In contrast, `r nrow(filter(analyses$WG.comprehension$sex$model_summary, p < .05, beta > 0))` showed a male advantage and the remainder did not show a significant gender by age interaction. 

Moving away from the model-based method above, we can look for a measure of effect size (similar to that used in the previous chapter). Effect size quantifies the size of the difference between groups in terms of the variability, producing a scale-free measure of difference that is appropriate for comparison across languages. Normally we'd use a measure like Cohen's $d$ here, where

$$d = \frac{\mu_2 - \mu_1}{SD_{pooled}}$$

But as in the previous chapter, we have the problem of non-normal distributions. To circumvent this issue, we use a non-parametric measure derived from the same components:  the difference between medians, divided by the MAD. (We call this the MMAD). 

```{r demo-gender_mmad_wg_comp}
ggplot(analyses$WG.comprehension$sex$mmad_ratio,
       aes(x = age, y = mmad)) +
  geom_jitter(aes(col = interaction(language, form, sep = .inst_sep))) +
  geom_smooth(span = 1, aes(group = 1)) +
  geom_hline(yintercept = 0, lty = 2, col = "gray") + 
  xlab("Age (months)")  + 
  ylab("MMAD (Female Advantage)") +
  scale_color_manual(values = inst_colours, name = "") + 
  theme(legend.position = "bottom",
        legend.text = element_text(size = 7)) 
```

```{r demo-mmad_plot}
ggplot(analyses$WG.comprehension$sex$mmad_summary, 
       aes(x = interaction(language, form), y = mmad_mean)) + 
  geom_point() + 
  coord_flip() + 
  ylab("Language") + 
  xlab("MMAD (Comprehension)") +
  geom_hline(aes(yintercept = 0), lty = 2, color = "gray") 
```
Applying this measure to the data on comprehension, we see a quite small average female advantage that appears relatively constant across age. For those languages with dense enough data, we can take a weighted average of this pattern across ages, which reveals substantial variability. The overall median for these `r nrow(analyses$WG.comprehension$sex$mmad_summary)` languages is quite small as well, `r round(median(analyses$WG.comprehension$sex$mmad_summary$mmad_mean),2)`. In summary, there is some evidence for a modest female advantage in comprehension. 


### Production (Words and Gestures)


```{r demo-gender_plot_wg_prod}
ggplot(analyses$WG.production$sex$means,
       aes(x = age, y = median, colour = sex)) +
  facet_wrap(~interaction(language, form, sep = .inst_sep)) +
  geom_point(alpha=.2, aes(size = n)) +
  geom_line(data = analyses$WG.production$sex$preds, aes(y = pred)) +
  .scale_colour_discrete(name="Sex") +
  scale_x_continuous(breaks = seq(8,
                                  20, 4),
                     limits = c(8, 20),
                     name = "Age (months)") +
  scale_y_continuous(breaks = c(0,.5,1), limits = c(0,1), 
                     name = "Median Production") +
  theme(legend.position = "bottom",
        strip.text.x = element_text(size = 7)) + 
  scale_size(guide = FALSE)
```


```{r demo-sex_prod_table}
analyses$WG.production$sex$model_summary %>%
  DT::datatable()
```
We next turn to production data. As in many of our subsequent analyses, data on production from Words and Gestures forms tend to be at floor, so they are of limited utility and the failure to find differences may reflect floor effects rather than any true differences. Visual inspection confirms differences at the edge of the age range covered by Words and Gestures forms, however, so for completeness we give the comparable statistical analyses as above. Here `r nrow(filter(analyses$WG.production$sex$model_summary, p < .05, beta < 0))` of `r nrow(analyses$WG.production$sex$model_summary)` languages show a statistically significant female advantage.

```{r demo-gender_mmad_wg_prod}
a <- ggplot(analyses$WG.production$sex$mmad_ratio,
            aes(x = age, y = mmad)) +
  geom_jitter(aes(col = interaction(language, form, sep = .inst_sep))) +
  geom_smooth(span = 1, aes(group = 1)) +
  geom_hline(yintercept = 0, lty = 2, col = "gray") + 
  scale_colour_manual(values = inst_colours, name = "") +
  xlab("Age (months)")  + 
  ylab("MMAD (Female Advantage)") + 
  theme(legend.position = "bottom") 

b <- ggplot(analyses$WG.production$sex$mmad_summary, aes(x = interaction(language, form, sep = .inst_sep), y = mmad_mean)) + 
  geom_point() + 
  # geom_pointrange(aes(ymin = mmad_ci_lower, ymax = mmad_ci_upper)) + 
  # ylim(0,1.5) + 
  coord_flip() + 
  ylab("Language") + 
  xlab("MMAD (Production)") +
  geom_hline(aes(yintercept = 0), lty = 2, color = "gray") 

gridExtra::grid.arrange(a, b, ncol=2)
```

Examining the MMAD effect size measures, it is clear that there is limited signal in early production but the overall trend appears to be for a slight developmental increase from around 12 - 20 months.  In addition, overall effect sizes are larger than in comprehension, with a median effect of `r round(median(analyses$WG.production$sex$mmad_summary$mmad_mean),2)`, though in this analysis, averaging across age may be less warranted.

### Production (Words and Sentences)

```{r demo-gender_plot_ws_prod}
ggplot(analyses$WS.production$sex$means,
       aes(x = age, y = median, colour = sex)) +
  facet_wrap(~interaction(language, form, sep = .inst_sep)) +
  geom_point(alpha=.2, aes(size=n)) +
  geom_line(data = analyses$WS.production$sex$preds, aes(y = pred)) +
  .scale_colour_discrete(name="Sex") +
  scale_x_continuous(breaks = seq(16,
                                  36, 8),
                     limits = c(16, 36),
                     name = "Age (months)") +
  scale_y_continuous(breaks = c(0,.5,1), limits = c(0,1), 
                     name = "Median Production") +
  theme(legend.position = "bottom",
        strip.text.x = element_text(size = 7)) + 
  scale_size(guide = FALSE)
```

```{r demo-ws_prod_table}
analyses$WS.production$sex$model_summary %>%
  DT::datatable()
```

We next turn to production data on the Words and Sentences instrument, which we expect to be much more informative regarding production.  Visual inspection confirms differences in almost every case, and an analysis of the fitted models shows that `r nrow(filter(analyses$WS.production$sex$model_summary, p < .05, beta < 0))` of `r nrow(analyses$WS.production$sex$model_summary)` languages show a statistically significant female advantage!

```{r demo-gender_mmad_ws_prod}
a <- ggplot(analyses$WS.production$sex$mmad_ratio,
            aes(x = age, y = mmad)) +
  geom_jitter(aes(col = interaction(language, form, sep = .inst_sep))) +
  geom_smooth(span = 1, aes(group = 1)) +
  geom_hline(yintercept = 0, lty = 2, col = "gray") + 
  scale_colour_manual(values = inst_colours, name = "") +
  xlab("Age (months)")  + 
  ylab("MMAD (Female Advantage)") + 
  theme(legend.position = "bottom") 

b <- ggplot(analyses$WS.production$sex$mmad_summary, 
            aes(x = interaction(language, form, sep = .inst_sep),
                y = mmad_mean)) + 
  geom_point() + 
  # geom_pointrange(aes(ymin = mmad_ci_lower, ymax = mmad_ci_upper)) + 
  # ylim(0,1.5) + 
  coord_flip() + 
  ylab("MMAD (Production)") +
  geom_hline(aes(yintercept = 0), lty = 2, color = "gray") 

gridExtra::grid.arrange(a, b, ncol=2)
```

We next turn to the MMAD effect size measure. Here we see a relatively consistent difference across ages with perhaps a slight downward trend in effect size. This downward trend might be a function of ceiling effects on the form, however, as seen in the model-fit curves above for, e.g., Danish. When variability is limited by the form ceiling, effect size estimates will necessarily be depressed. The median female advantage is `r round(median(analyses$WS.production$sex$mmad_summary$mmad_mean),2)`, substantially larger than that seen in early comprehension and somewhat larger than that seen in early production (perhaps due to floor effects early on). 

### Reporting Bias?

Do these differences reflect differences in measurement that are unique to the CDI? One way of addressing this question is to examine other studies of gender differences that have been found in other studies. Unfortunately, many of the studies reporting differences themselves rely on the CDI, likely for the reasons reviewed in Chapter \@ref(intro-practical), e.g. [@bauer2002;@fenson1994;@feldman2000]. For example, @feldman2000 collected CDIs with a large dataset of low-income American English speakers at 12 and 24 months. In those data, early comprehension showed no significant gender differences, but production at 24 months showed a difference comparable to what we observed here ($N = 2156$, $d = .35$, recomputed from provided summary statistics). These data, while providing replication in an independent dataset, do not speak to whether reporting biases contributed to or created the observed sex effects. 

For external validation, we turn to two other studies that provide more objective (non parent-report) measurements of early language. First, a seminal study by @huttenlocher1991 measured gender effects in vocabulary production as estimated from a naturalistic language sample, finding substantial differences in vocabulary growth favoring girls. Although the measures from this study are not comparable to the current data, the effects are quite large (and are relatively unaffected by controlling for maternal language exposure). 


```{r demo-bornstein}
b2012 <- read_csv("data/demographics/bornstein2012_combined.csv")
nrow(b2012)

qplot(z_20, z_48, col = gender, pch = gender, data = b2012) +
  .scale_colour_discrete() + 
  xlab("Standardized Language at 20 Months") + 
  ylab("Standardized Language at 48 Months") + 
  geom_smooth(method = "lm")

b2012_summary <- b2012 %>%
  group_by(gender) %>%
  do(data.frame(rbind(Hmisc::smean.cl.boot(.$z_20))))
```

Second, @bornstein2012 use a particularly powerful study design to examine stability in early language estimates across different measures. They gathererd longitudinal data at 20 and 48 months using a wide range of standardized and parent-report measures, and then use structural equation modeling to model shared variance due to parent report as well as standardized latent language ability at each age. We digitized data from their Figure 2 to examine the size of the gender differences in the latent vocabulary construct that they recovered.^[These data are not perfect, I have double-digitized one point.] As these scores are standardized, we can examine the difference in means and recover the standardized effect size for gender in the data, which is `r round(-diff(b2012_summary$Mean), 2)` standard deviations. Since this measurement is *greater* than that found using the CDIs (the comparable American English measurement was `r round(filter(analyses$WS.production$sex$mmad_summary, language == "English (American)") %>% pull(mmad_mean), 2)`), we doubt that our observed effect is due solely to reporting bias. 

### Discussion

In summary, we found a considerable and strikingly consistent cross-linguistic female advantage in early language production [replicating and extennding @eriksson2012]. A much smaller but still relatively consistent female advantage was reported in comprehension. We suspect that neither of these effects are due to parental reporting bias. First, our review of the literature suggests that studies using direct assessments yield similar effects to the extent that we were able to compare. Second, comprehension is very likely to be the measure *more* affected by reporting biases as it is likely to be more subjective [@feldman2000;@fenson2000]. In contrast, we find a much smaller gender effect in comprehension. As noted above, we remain agnostic about the causes of these differences, but in Chapter \@ref(conclusion-consistency) we discuss inferences from consistency across languages in much more detail.


## Birth order

Another factor that may contribute to individual differences in children's vocabulary development is birth order.  The literature suggests some evidence for a first-born advantage in early vocabulary development, but these differences are small and tend to be most evident early in development.  For example, @bornstein2004 found that mothers report larger receptive and expressive vocabularies in their first-borns. Using naturalistic language samples, @berglund2005 found that first-born children reached the 50-word milestone earlier than later-born children, but that birth order differences diminished later in development. Finally, @hoff-ginsberg1998 found that first-born children were more advanced in vocabulary development than later-born children, but that later-born children were more advanced in their conversational skills. This may be attributed to “differences in early language experience” that “may set the stage for later developmental differences” (p. 603). 

Here, we can examine birth order effects in early vocabulary comprehension and production in a few languages in our sample.  Only `r length(unique(filter(vocab_data,!is.na(birth_order))$language))` languages have birth order data, with data available only for `r length(unique(filter(vocab_data,!is.na(birth_order), form == "WS")$language))` languages for Words and Sentences, and only `r length(unique(filter(vocab_data,!is.na(birth_order), form == "WG")$language))` languages for Words and Gestures.

### Comprehension

```{r demo-birth_order_wg_comp}
ggplot(analyses$WG.comprehension$birth_order$means,
       aes(x = age, y = median, colour = birth_order,
           label = birth_order)) +
  facet_wrap( ~interaction(language, form, sep = .inst_sep)) +
  geom_point(alpha=.2, aes(size = n)) +
  geom_line(data = analyses$WG.comprehension$birth_order$preds, aes(y = pred)) +
  .scale_colour_discrete(name="Birth Order") +
  scale_x_continuous(breaks = seq(8, 20, 4),
                     limits = c(8, 20),
                     name = "Age (months)") +
  ylab("Median Comprehension") +
  ylim(c(0, 1)) +
  theme(legend.position = "bottom",
        strip.text.x = element_text(size = 7)) + 
  scale_size(guide = FALSE)

analyses$WG.comprehension$birth_order$model_summary %>%
  DT::datatable()

a <- ggplot(analyses$WG.comprehension$birth_order$mmad_ratio,
            aes(x = age, y = mmad)) +
  geom_jitter(aes(col = interaction(language, form, sep = .inst_sep))) +
  geom_smooth(span = 1, aes(group = 1)) +
  geom_hline(yintercept = 0, lty = 2, col = "gray") + 
  scale_colour_manual(values = inst_colours, name = "") +
  xlab("Age (months)")  + 
  ylab("MMAD (First-Born Advantage)") + 
  theme(legend.position = "bottom") 

b <- ggplot(analyses$WG.comprehension$birth_order$mmad_summary, 
            aes(x = interaction(language, form), y = mmad_mean)) + 
  geom_point() + 
  # geom_pointrange(aes(ymin = mmad_ci_lower, ymax = mmad_ci_upper)) + 
  # ylim(0,1.5) + 
  coord_flip() + 
  ylab("MMAD (Production)") +
  geom_hline(aes(yintercept = 0), lty = 2, color = "gray") 

gridExtra::grid.arrange(a, b, ncol=2)
```



### Production (WG)

```{r demo-birth_order_wg_prod}
ggplot(analyses$WG.production$birth_order$means,
       aes(x = age, y = median, colour = birth_order,
           label = birth_order)) +
  facet_wrap( ~interaction(language, form, sep = .inst_sep)) +
  geom_point(alpha=.2) +
  geom_line(data = analyses$WG.production$birth_order$preds, aes(y = pred)) +
  .scale_colour_discrete(name="Birth Order") +
  scale_x_continuous(breaks = seq(8, 20, 4),
                     limits = c(8, 20),
                     name = "Age (months)") +
  ylab("Median Productive Vocabulary") +
  ylim(c(0, 1)) +
  theme(legend.position = "bottom")

analyses$WG.production$birth_order$model_summary %>%
  DT::datatable()

a <- ggplot(analyses$WG.production$birth_order$mmad_ratio,
            aes(x = age, y = mmad)) +
  geom_jitter(aes(col = interaction(language, form, sep = .inst_sep))) +
  geom_smooth(span = 1, aes(group = 1)) +
  geom_hline(yintercept = 0, lty = 2, col = "gray") + 
  scale_colour_manual(values = inst_colours, name = "") +
  xlab("Age (months)")  + 
  ylab("MMAD (First Born Advantage)") + 
  theme(legend.position = "bottom") 

b <- ggplot(analyses$WG.production$birth_order$mmad_summary, aes(x = language, y = mmad_mean)) + 
  geom_point() + 
  # geom_pointrange(aes(ymin = mmad_ci_lower, ymax = mmad_ci_upper)) + 
  # ylim(0,1.5) + 
  coord_flip() + 
  ylab("MMAD (Production)") +
  geom_hline(aes(yintercept = 0), lty = 2, color = "gray") 

gridExtra::grid.arrange(a, b, ncol=2)
```

### Production (WS)

```{r demo-birth_order_ws_prod}
ggplot(analyses$WS.production$birth_order$means,
       aes(x = age, y = median, colour = birth_order,
           label = birth_order)) +
  facet_wrap( ~interaction(language, form, sep = .inst_sep)) +
  geom_point(alpha=.2) +
  geom_line(data = analyses$WS.production$birth_order$preds, aes(y = pred)) +
  .scale_colour_discrete(name="Birth Order") +
  scale_x_continuous(breaks = seq(16, 36, 8),
                     limits = c(16, 36),
                     name = "Age (months)") +
  ylab("Median Productive Vocabulary") +
  ylim(c(0, 1)) +
  theme(legend.position = "bottom")

analyses$WS.production$birth_order$model_summary %>%
  DT::datatable()

a <- ggplot(analyses$WS.production$birth_order$mmad_ratio,
            aes(x = age, y = mmad)) +
  geom_jitter(aes(col = interaction(language, form, sep = .inst_sep))) +
  geom_smooth(span = 1, aes(group = 1)) +
  geom_hline(yintercept = 0, lty = 2, col = "gray") + 
  scale_colour_manual(values = inst_colours, name = "") +
  xlab("Age (months)")  + 
  ylab("MMAD (First-Born Advantage)") + 
  theme(legend.position = "bottom") 

b <- ggplot(analyses$WS.production$birth_order$mmad_summary, 
            aes(x = interaction(language, form, sep = .inst_sep),
                y = mmad_mean)) + 
  geom_point() + 
  # geom_pointrange(aes(ymin = mmad_ci_lower, ymax = mmad_ci_upper)) + 
  # ylim(0,1.5) + 
  coord_flip() + 
  ylab("MMAD (Production)") +
  geom_hline(aes(yintercept = 0), lty = 2, color = "gray") 

gridExtra::grid.arrange(a, b, ncol=2)
```


## Socioeconomic status

From health to education, children from lower socioeconomic status (SES) backgrounds tend to be at higher risk for a variety of negative developmental outcomes, compared to their higher-SES peers [@bradley2002]. A large literature documents specific relations between SES and children’s early language abilities, especially oral vocabulary, which is in turn related to outcomes when children begin formal education [e.g., @hart1995; @hoff2003; @fernald2013]. The parent report method allows the assessment of the influence of SES on vocabulary outcomes earlier in development than is possible with direct assessments.  Using the CDI Words and Sentences form, @arriaga1998 compared the language skills in 103 very low-income toddlers with a sample of middle-income toddlers from the @fenson2007 norming sample, matched on age and sex. They found that the vocabulary production scores for the low-income group were consistently about 30% lower than those for the middle-income group.  The size of these effects suggest that differences in SES are evident from the earliest phases of language development. 

Environmental explanations of these SES effects are often given in terms of indirect factors that affect life opportunities or experiences, such as nutrition and access to health care, as well as more direct factors that impact daily life, such as smoking during pregnancy, access to quality child care, or amount of time caregivers spend in interactions with their young children. Alternatively, even early language shows a significant genetic component, raising the possibility that SES-vocabulary links may instead be genetically mediated [@hayiou-thomas2012].  

In the current dataset, we have the opportunity to explore the extent of these effects across several language communities.  Cross-language comparisons may shed light on the factors that lead to relations between SES and children’s vocabulary outcomes. On the one hand, relatively constant relations across language communities that vary widely in indirect and direct factors that shape learning would provide prima facie support for genetic explanations. In contrast, a greater degree of cross-language variability would point to the origins of SES effects in aspects of children’s early environments that vary with SES to differing degrees across countries [e.g., @lfernald2012.  We use maternal education as a proxy for SES, following previous work suggesting that maternal education is strongly related to SES variation [@bornstein2003; @hoff2003].

<!-- We use maternal education as a proxy for socio-economic status. -->

```{r demo-momed_wg_comp}
ggplot(analyses$WG.comprehension$mom_ed$means,
       aes(x = age, y = median, colour = mom_ed,
           label = mom_ed)) +
  facet_wrap( ~interaction(language, form, sep = .inst_sep)) +
  geom_point(alpha=.2) +
  geom_line(data = analyses$WG.comprehension$mom_ed$preds, aes(y = pred)) +
  .scale_colour_discrete(name="Maternal Education") +
  scale_x_continuous(breaks = seq(8, 20, 4),
                     limits = c(8, 20),
                     name = "Age (months)") +
  ylab("Median Comprehension") +
  ylim(c(0, 1)) +
  theme(legend.position = "bottom",
        strip.text.x = element_text(size = 7)) + 
  scale_size(guide = FALSE)

analyses$WG.comprehension$mom_ed$model_summary %>%
  DT::datatable()

a <- ggplot(analyses$WG.comprehension$mom_ed$mmad_ratio,
            aes(x = age, y = mmad, col = language)) +
  geom_jitter() +
  geom_smooth(span = 1, aes(group = 1)) +
  geom_hline(yintercept = 0, lty = 2, col = "gray") + 
  scale_colour_manual(values = lang_colours, name = "") +
  xlab("Age (months)")  + 
  ylab("MMAD (College Advantage)") + 
  theme(legend.position = "bottom") 

b <- ggplot(analyses$WG.comprehension$mom_ed$mmad_summary, aes(x = language, y = mmad_mean)) + 
  geom_point() + 
  # geom_pointrange(aes(ymin = mmad_ci_lower, ymax = mmad_ci_upper)) + 
  # ylim(0,1.5) + 
  coord_flip() + 
  ylab("MMAD (Comprehension)") +
  geom_hline(aes(yintercept = 0), lty = 2, color = "gray") 

gridExtra::grid.arrange(a, b, ncol=2)
```



### Production (WG)

```{r demo-momed_wg_prod}
ggplot(analyses$WG.production$mom_ed$means,
       aes(x = age, y = median, colour = mom_ed,
           label = mom_ed)) +
  facet_wrap( ~language) +
  geom_point(alpha=.2) +
  geom_line(data = analyses$WG.production$mom_ed$preds, aes(y = pred)) +
  .scale_colour_discrete(name="Maternal Education") +
  scale_x_continuous(breaks = seq(8, 20, 4),
                     limits = c(8, 20),
                     name = "Age (months)") +
  ylab("Median Productive Vocabulary") +
  ylim(c(0, 1)) +
  theme(legend.position = "bottom")

analyses$WG.production$mom_ed$model_summary %>%
  DT::datatable()

a <- ggplot(analyses$WG.production$mom_ed$mmad_ratio,
            aes(x = age, y = mmad)) +
  geom_jitter(aes(col = language)) +
  geom_smooth(span = 1, aes(group = 1)) +
  geom_hline(yintercept = 0, lty = 2, col = "gray") + 
  scale_colour_manual(values = lang_colours, name = "") +
  xlab("Age (months)")  + 
  ylab("MMAD (College Advantage)") + 
  theme(legend.position = "bottom") 

b <- ggplot(analyses$WG.production$mom_ed$mmad_summary, aes(x = language, y = mmad_mean)) + 
  geom_point() + 
  # geom_pointrange(aes(ymin = mmad_ci_lower, ymax = mmad_ci_upper)) + 
  # ylim(0,1.5) + 
  coord_flip() + 
  ylab("MMAD (Production)") +
  geom_hline(aes(yintercept = 0), lty = 2, color = "gray") 

gridExtra::grid.arrange(a, b, ncol=2)
```

### Production (WS)

```{r demo-momed_ws_prod}
ggplot(analyses$WS.production$mom_ed$means,
       aes(x = age, y = median, colour = mom_ed)) +
  facet_wrap( ~language) +
  geom_point(alpha=.2) +
  geom_line(data = analyses$WS.production$mom_ed$preds, aes(y = pred)) +
  .scale_colour_discrete(name="Maternal Education") +
  scale_x_continuous(breaks = seq(16, 36, 8),
                     limits = c(16, 36),
                     name = "Age (months)") +
  ylab("Median Productive Vocabulary") +
  ylim(c(0, 1)) +
  theme(legend.position = "bottom")

analyses$WS.production$mom_ed$model_summary %>%
  DT::datatable()

a <- ggplot(analyses$WS.production$mom_ed$mmad_ratio,
            aes(x = age, y = mmad)) +
  geom_jitter(aes(col = language)) +
  geom_smooth(span = 1, aes(group = 1)) +
  geom_hline(yintercept = 0, lty = 2, col = "gray") + 
  scale_colour_manual(values = lang_colours, name = "") +
  xlab("Age (months)")  + 
  ylab("MMAD (College Advantage)") + 
  theme(legend.position = "bottom") 

b <- ggplot(analyses$WS.production$mom_ed$mmad_summary, aes(x = language, y = mmad_mean)) + 
  geom_point() + 
  # geom_pointrange(aes(ymin = mmad_ci_lower, ymax = mmad_ci_upper)) + 
  # ylim(0,1.5) + 
  coord_flip() + 
  ylab("MMAD (Production)") +
  geom_hline(aes(yintercept = 0), lty = 2, color = "gray") 

gridExtra::grid.arrange(a, b, ncol=2)
```

### Explanations

Our findings show that the relations between maternal education and children’s vocabulary outcomes is highly variable across countries. The observational nature of our data precludes strong inferences about the precise factors that lead to these differences, though speculation is certainly possible. The large magnitude of the differences across countries suggests a powerful role for environmental factors in shaping variation in child outcomes even before the age of 3 years. Findings from the present study support the proposal that inequalities in factors that are linked to child well being should be addressed early in life. Since features of the quantity and quality of caregiver linguistic input has been strongly implicated in early language development, future research should focus on policy interventions that facilitate children’s access to  high quality talk by caregivers, including care availability and parental leave. 

### Reporting biases

While lower scores on the vocabulary checklists can reflect authentic differences across children from different SES groups, it is also possible that some of these SES effects are the result of differential reporting biases [for discussion, see @fenson2007].  For example, in @feldman2000's study of more than 2000 children, vocabulary comprehension scores on the Words and Gestures form were higher for caregivers with lower education than for caregivers with higher education, whereas, the opposite relation was found for vocabulary production and later grammar skills from the Words and Sentences form.  Thus, parents with low educational and income levels seem to overestimate their child’s comprehension abilities in comparison with parents with more education and income, especially early in development. Parents, in general, are likely to have difficulty making judgments about early comprehension.  Overreporting may occur for those subscales of the CDI that require inference on the part of the parent, for example, when they have to separate evidence of comprehension of a word in isolation from that word taken together with the non-linguistic cues that are likely to support a child's appropriate behavior in a highly constrained context. In addition, some parents may recall times when the words were used in the child’s presence and may confuse exposure with understanding. These difficulties may explain why parental reports of verbal comprehension in this age range are higher than results of direct testing [@tomasello1994] and why correlations between parental reports and comprehension scores from other methods are extremely low [@goldfield1990].



```{r demo-cvs}
cvs <- expand.grid(measures = c("WS.production","WG.production","WG.comprehension"),
           demos = c("birth_order","sex","mom_ed")) %>%
  mutate(index = 1:n()) %>%
  split(.$index) %>%
  map_df(function(x) {
    analyses[[as.character(x$measures)]][[as.character(x$demos)]]$mmad_summary %>%
      summarise(cv = cv(mmad_mean), 
                sem = cv_sem(mmad_mean), 
                n = n()) %>%
      mutate(category = "Vocabulary",
             signature = x$demos, 
             measure = x$measures) 
  }) %>%
  filter(measure %in% c("WG.comprehension","WS.production")) %>%
  mutate(measure = fct_recode(measure, 
                              comprehension = "WG.comprehension", 
                              production = "WS.production"))

write_feather(cvs, "data/cvs/demographic_cvs.feather")
```



<!-- After we get the data finalized, we can see if there is evidence for reporting bias in these data.

```{r demo-early_comp}
early_comprehension <- vocab_data %>%
  filter(form == "WG", age < 13, !is.na(mom_ed)) %>%
  group_by(language, mom_ed, age) %>%
  summarise(median = median(comprehension / n), 
            n = n())

ggplot(early_comprehension, 
       aes(x = age, y = median, col = mom_ed)) + 
  geom_point(aes(size = n), position = "dodge") + 
  facet_wrap(~language) + 
  .scale_colour_discrete() +
  geom_smooth(se=FALSE, span = 2)
# geom_smooth(method = "lm", se = FALSE, formula = y ~ x)
```

--->

